process RECO =
{
   untracked PSet maxEvents =
   {
      untracked int32 input = 1
   }

   source = PoolSource
   {
     untracked vstring fileNames =
      {
                "rfio:/castor/cern.ch/cms/store/cmshi/mc/sim/pgun_jpsi2muons_d20080423/pgun_jpsi2muons_d20080423_r000001.root"
      }
   }

#
#  For running on signal only, comment out the whole Mixing Module and
#  uncomment the line below:
#
#  include "Configuration/StandardSequences/data/MixingNoPileUp.cff"

include "HeavyIonsAnalysis/Configuration/data/EventEmbedding.cff"
   module mix = MixingModule
   {
      secsource input = PoolRASource
      {
         untracked vstring fileNames =
         {
                "rfio:/castor/cern.ch/cms/store/cmshi/mc/sim/hydjet_sim_x2_c1_d20080425/hydjet_sim_x2_c10_d20080425_r000002.root"
         }
 	using eventEmbeddingSourceParameters
      }
	using simEventEmbeddingMixParameters
   }

#
#  Do not forget to change seed for productions mode
#    
   service = RandomNumberGeneratorService
   {
      untracked uint32 sourceSeed                = 1
      PSet moduleSeeds =
      {
         untracked uint32 VtxSmeared             = 2
         untracked uint32 g4SimHits              = 3
         untracked uint32 mix                    = 4
         untracked uint32 hcalDigis              = 5
         untracked uint32 muonCSCDigis           = 6
         untracked uint32 muonDTDigis            = 6
         untracked uint32 muonRPCDigis           = 6
         untracked uint32 siPixelDigis           = 7
         untracked uint32 siStripDigis           = 7
         untracked uint32 ecalUnsuppressedDigis  = 8
         untracked uint32 hcalUnsuppressedDigis  = 9
      }
   }

service = SimpleMemoryCheck {
      untracked int32 ignoreTotal = 0 # default is one
      untracked bool oncePerEventMode = false
}

   service = MessageLogger
   {
    untracked vstring debugModules =  { "towerMaker" , "caloTowers", "iterativeConePu5CaloJets" }

      untracked vstring destinations =  { "cout", "cerr" }
      untracked vstring fwkJobReports = { "FrameworkJobReport.xml" }
      untracked PSet cerr             = { untracked string threshold = "DEBUG" }
      untracked PSet cout             = { untracked string threshold = "DEBUG" }
   }

   service = Timing {}

   include "Configuration/EventContent/data/EventContent.cff"
   include "Configuration/StandardSequences/data/Digi.cff"
   include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"

   # Fake running conditions
   include "Configuration/StandardSequences/data/FakeConditions.cff"

    include "Geometry/RPCGeometry/data/rpcGeometry.cfi" 
    include "Geometry/CSCGeometry/data/cscGeometry.cfi"

    include "SimMuon/RPCDigitizer/data/muonrpcdigi.cfi"

##################################################################################

    include "HeavyIonsAnalysis/Configuration/data/Reconstruction_PbPb.cff"

##################################################################################

    # path
   path p = { mix, doAllDigi, 

	      reconstruct_PbPb

            }

   include "HeavyIonsAnalysis/Configuration/data/HIAnalysisEventContent.cff"

   module output = PoolOutputModule
   {
      untracked string fileName = "jpsi2muons_PbPb_RECO.root"
      untracked int32 compressionLevel = 2
      untracked uint32 commitInterval = 1

      using HIRecoObjects
   }

   replace output.outputCommands += "keep *_*_*_RECO"

   endpath outpath = { output }
}
