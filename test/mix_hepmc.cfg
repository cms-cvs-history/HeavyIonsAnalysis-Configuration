process GEN =
{
   untracked PSet maxEvents =
   {
      untracked int32 input = 1
   }

   source = PoolSource
   {
     untracked vstring fileNames =
      {
                "rfio:/castor/cern.ch/cms/store/cmshi/mc/sim/pgun_jpsi2muons_d20080423/pgun_jpsi2muons_d20080423_r000001.root"
      }
   }

#
#  For running on signal only, comment out the whole Mixing Module and
#  uncomment the line below:
#
#  include "Configuration/StandardSequences/data/MixingNoPileUp.cff"

include "HeavyIonsAnalysis/Configuration/data/EventEmbedding.cff"
   module mix = MixingModule
   {
      secsource input = PoolRASource
      {
         untracked vstring fileNames =
         {
                "rfio:/castor/cern.ch/cms/store/cmshi/mc/sim/hydjet_sim_x2_c1_d20080425/hydjet_sim_x2_c1_d20080425_r000002.root"
         }
 	using eventEmbeddingSourceParameters
      }

   using genEventEmbeddingMixParameters

   }

   service = RandomNumberGeneratorService
   {
      untracked uint32 sourceSeed                = 1
      PSet moduleSeeds =
      {
         untracked uint32 VtxSmeared             = 2
         untracked uint32 mix                    = 4
      }
   }

service = SimpleMemoryCheck {
      untracked int32 ignoreTotal = 0 # default is one
      untracked bool oncePerEventMode = false
}

   service = MessageLogger
   {
    untracked vstring debugModules =  { "mix" }

      untracked vstring destinations =  { "cout", "cerr" }
      untracked vstring fwkJobReports = { "FrameworkJobReport.xml" }
      untracked PSet cerr             = { untracked string threshold = "DEBUG" }
      untracked PSet cout             = { untracked string threshold = "DEBUG" }
   }

   service = Timing {}

   include "Configuration/EventContent/data/EventContent.cff"
   include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"

    # path
   path p = { mix }


#
# The following is a good module to test if the mixing has worked
# it loops through the HepMCProducts in the CrossingFrame and
# counts number of particles
#
# module testmix = ListImpParameter {
#   untracked bool doMixed = true
# }
#
# path test = { testmix }
#

   include "HeavyIonsAnalysis/Configuration/data/HIAnalysisEventContent.cff"

   module output = PoolOutputModule
   {
      untracked string fileName = "jpsi2muons_PbPb_GEN.root"
      untracked int32 compressionLevel = 2
      untracked uint32 commitInterval = 1

      using HIRecoObjects
   }

   replace output.outputCommands += "keep *_*_*_GEN"

   endpath outpath = { output }
}
